---
title: "Elliptic Partial Differential Equations"
format: html
jupyter: python3
---

**Pavni:** We’ve seen waves (hyperbolic) and diffusion (parabolic). What are elliptic PDEs about?

**Acharya:** Elliptic PDEs describe *steady-state* or equilibrium phenomena where time is no longer present. Typical examples are steady heat conduction, electrostatics (potential problems), and incompressible potential flow.

**Pavni:** So instead of marching forward in time we solve for the entire spatial field at once?

**Acharya:** Exactly. That changes both our modelling viewpoint and the numerical tools: we discretize the spatial domain and solve a (usually large) algebraic system.

## Prototypical equations

The two classical elliptic equations in two dimensions are

- **Laplace equation** (no sources):
  
  $$
  u_{xx} + u_{yy} = 0,
  $$

- **Poisson equation** (with sources):

  $$
  u_{xx} + u_{yy} = f(x,y).
  $$

Boundary conditions determine a well-posed problem (Dirichlet, Neumann, Robin).

A second-order linear PDE in 2D written as

$$
A u_{xx} + 2B u_{xy} + C u_{yy} + \dots = 0
$$

is **elliptic** at a point if the discriminant satisfies

$$
B^2 - AC < 0.
$$

This local condition corresponds to the absence of real characteristic curves — there is no natural direction for propagation.

## Boundary conditions

- **Dirichlet:** prescribe $u$ on the boundary (value-driven).  
- **Neumann:** prescribe normal derivative $\partial_n u$ on the boundary (flux-driven).  
- **Robin:** linear combination of Dirichlet and Neumann.

**Pavni:** Which ones are easiest numerically?

**Acharya:** Dirichlet is simplest to impose in most finite-difference or finite-element contexts. Neumann requires consistent discretizations near the boundary (ghost points or one-sided differences).

## Finite difference discretization — Laplace on a square

We illustrate with the unit square $\Omega = (0,1)^2$ and Dirichlet boundary conditions.

Use a uniform grid with spacing $h=1/(N+1)$ and interior nodes $(x_i,y_j)$ where $i,j=1,\dots,N$.

Central differences give the five-point stencil at interior node $(i,j)$:

$$
\frac{u_{i-1,j} - 2u_{i,j} + u_{i+1,j}}{h^2} + \frac{u_{i,j-1} - 2u_{i,j} + u_{i,j+1}}{h^2} = f_{i,j}.
$$

Rearrange to the canonical form:

$$
- u_{i-1,j} - u_{i+1,j} - u_{i,j-1} - u_{i,j+1} + 4 u_{i,j} = h^2 f_{i,j}.
$$

This couples each grid point to its four neighbours.

---

**Pavni:** Wait, what happens along the edges of the square? We’re only writing difference equations for the interior nodes.

**Acharya:** Good observation. On the boundaries, we must specify **boundary conditions** to make the problem well posed.  
In this example, we assume **homogeneous Dirichlet conditions**, meaning
$$
u(x,y) = 0 \quad \text{for } (x,y) \text{ on the boundary of } \Omega = (0,1)^2.
$$

That’s like a square metal plate whose edges are held at zero temperature while heat is generated inside.  

**Pavni:** So the temperature is fixed to zero all around, and the source term \(f(x,y)=1\) keeps the interior warm?

**Acharya:** Exactly. Numerically, we handle this by solving only for the **interior grid points**.  
The grid spacing is \(h = 1/(N+1)\), so the first and last rows/columns correspond to the boundary, where \(u=0\).  
We don’t include those nodes in our system — the matrix \(A\) acts only on interior unknowns, which implicitly enforces \(u=0\) on the edges.

**Pavni:** That makes sense — so every \(u_{i,j}\) we compute corresponds to an interior temperature, with the boundaries fixed to zero.

---

## Matrix form and properties

Ordering unknowns lexicographically (e.g. row-wise), the discrete Laplacian leads to a linear system

$$
A \mathbf{u} = \mathbf{b}.
$$

Key properties of the matrix $A$ for the standard five-point Laplacian with Dirichlet BCs:

- symmetric  
- sparse (banded block structure)  
- positive-definite (for Poisson with Dirichlet BCs)

These properties guide solver choices — conjugate gradient (CG) is an excellent option when $A$ is SPD.

## Simple solvers (algorithmic sketch)

**Pavni:** Which solver should I try first?

**Acharya:** Start with iterative smoothers and then try Krylov methods:

- **Jacobi** (easy, textbook): parallel-friendly but slow.  
- **Gauss–Seidel** (faster; sequential).  
- **Successive Over-Relaxation (SOR)** (tune relaxation parameter $\omega$).  
- **Conjugate Gradient** with an incomplete Cholesky or algebraic multigrid preconditioner for large problems.

## Example: Python — assemble and solve small Poisson

```{python}
#| code-fold: true
#| code-summary: "Show solver code"
#| fig-cap: "Poisson solution on unit square (Dirichlet 0, f≡1) and its 3D surface."
#| warning: false
#| message: false
#| fig-width: 6
#| fig-height: 5

import numpy as np
import matplotlib.pyplot as plt
from scipy.sparse import diags
from scipy.sparse.linalg import spsolve

# small example N x N interior points
N = 20
h = 1.0/(N+1)

# 1D Laplacian block
T = diags([1,-2,1], [-1,0,1], shape=(N,N)).toarray()
I = np.eye(N)
A = (np.kron(I, T) + np.kron(T, I)) / h**2

# RHS f(x,y) = 1.0
b = np.ones(N*N)

# Solve (for small N we use direct)
u = np.linalg.solve(A, b)

# reshape to 2D for plotting or inspection
U = u.reshape((N,N))

# Build coordinates for plotting
x = np.linspace(h, 1 - h, N)
y = np.linspace(h, 1 - h, N)

# --- 2D heatmap
plt.figure(figsize=(6,5))
plt.imshow(U, origin="lower", extent=[0, 1, 0, 1], aspect="auto")
plt.colorbar(label="u(x,y)")
plt.title("Poisson solution on unit square (Dirichlet 0, f≡1)")
plt.xlabel("x"); plt.ylabel("y"); plt.tight_layout()
plt.show()

# --- 3D surface
from mpl_toolkits.mplot3d import Axes3D
X, Y = np.meshgrid(x, y)
fig = plt.figure(figsize=(6,5))
ax = fig.add_subplot(111, projection='3d')
ax.plot_surface(X, Y, U, cmap='viridis')
ax.set_title('3D surface of Poisson solution')
ax.set_xlabel('x'); ax.set_ylabel('y'); ax.set_zlabel('u(x,y)')
plt.tight_layout()
plt.show()
```
## Interpreting the results

**Pavni:** The plots look nice — I can see the solution forming a kind of smooth hill in the middle.  
But what exactly does this represent?

**Acharya:** Think of $$u(x,y)$$ as the **steady-state temperature** in a thin square plate.  
The plate’s edges are held at zero temperature (Dirichlet $$u=0$$), and there’s a uniform internal heat source $$f(x,y)=1$$.  

**Pavni:** So the heat source keeps trying to raise the temperature, but the cold edges pull it down?

**Acharya:** Exactly. The result is a smooth equilibrium temperature field that’s **highest at the center** and decreases smoothly toward the edges.  
The 2D heatmap shows this distribution in color, while the 3D surface plot visualizes it as a gentle “bowl” or “dome.”

**Pavni:** And the symmetry — the peak in the center — is because the geometry and source are symmetric?

**Acharya:** Correct. Because both the domain $$\Omega=(0,1)^2$$ and the forcing $$f(x,y)=1$$ are symmetric, the solution $$u(x,y)$$ is also symmetric about the midlines $$x=0.5$$ and $$y=0.5$$.  
In more complex problems, asymmetry in boundary conditions or forcing breaks that symmetry.

**Pavni:** Does the maximum always occur at the center for such problems?

**Acharya:** For the Laplace or Poisson equations with positive $$f(x,y)$$, yes — the **maximum principle** tells us that $$u$$ reaches its maximum on the boundary unless there’s a source inside.  
Here, the internal source $$f>0$$ allows an interior maximum at the center, which is exactly what you see.

**Pavni:** That’s elegant — the plots are telling us the physics of the PDE!

**Acharya:** Exactly. Numerical results are meaningful only when we interpret them through the governing equations and boundary conditions.  
Always connect the shape of the solution to *how the PDE balances diffusion and forcing*.
